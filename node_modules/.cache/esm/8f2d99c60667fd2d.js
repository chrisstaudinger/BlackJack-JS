let Deck,getRandomInt;_066‍.w("./cards.js",[["default",["Deck"],function(v){Deck=v}],["getRandomInt",["getRandomInt"],function(v){getRandomInt=v}]]);
const readLineSync = require('readline-sync')

const playerName = () => readLineSync.question("Please enter your Player name: ")


const startGameOptions = [
    "Deal"
]

const aceOptions = [""]

const player = {
  name: playerName(),
  cards: []
}
const house = {
  name: "House",
  cards: []
}

const playerMoveOptions = ['Hit', 'Stand']

const cardTotalValue = (obj) => {
  let totalCardValue = 0
  obj.cards.forEach(card => {
    totalCardValue += card.value
  })
  return totalCardValue
}

const houseMove = (obj, opponent) => {
  let cardTotal = cardTotalValue(obj)
  while (cardTotal < 17) {
  obj.cards.push(Deck.dealHouse())
  cardTotal = cardTotalValue(obj)
  _066‍.g.console.log(inRoundSummary(obj))
  _066‍.g.console.log(inRoundResultHouse(obj, opponent))
  }
}

const bust = (opponent) => {
  console.log(`Bust!\n${opponent.name} wins!`)
  return process.exit("Thanks for playing :)")
}

const blackjack = (obj) => {
  console.log(`BlackJack! ${obj.name} wins!`)
  return process.exit("Thanks for playing :)")
}

const playerMoveMenu = (options) => {
  let userChoice = readLineSync.keyInSelect(options)
  switch (userChoice) {
    case 0:
      player.cards.push(Deck.dealPlayer())
      _066‍.g.console.log(inRoundSummary(player))
      _066‍.g.console.log(inRoundResult(player, house))
      playerMoveMenu(options)
      break;
    case 1:
      console.log("You have chosen to sit\n")
      _066‍.g.console.log(houseMove(house, player))
  }
}

const startGameMenu = (options) => {
  let userChoice = readLineSync.keyInSelect(options)
  switch (userChoice) {
    case 0:
      player.cards.push(Deck.dealPlayer())
      house.cards.push(Deck.dealHouse())
      player.cards.push(Deck.dealPlayer())
      _066‍.g.console.log(inRoundSummary(player))
      _066‍.g.console.log(inRoundResult(player, house))
      playerMoveMenu(playerMoveOptions)
      break;
  } 
}

const inRoundSummary = (obj) => {
  obj.cards.forEach(card => {
    console.log(`${obj.name} has a ${card.type}`)
  })
  let cardTotal = cardTotalValue(obj)
  return `${obj.name}'s total card value is ${cardTotal}\n`
}

const inRoundResult = (player, opponent) => {
  if (cardTotalValue(player) === 21) {
    return blackjack(player)
  } else if (cardTotalValue(player) > 21) {
    return bust(opponent)
  } else {
    return "It's your move. What would you like to do?"
  }
}

const inRoundResultHouse = (obj, opponent) => {
  if (cardTotalValue(obj) === 21) {
    return blackjack(obj)
  } else if (cardTotalValue(obj) > 21) {
    return bust(opponent)
  } else {
    if (cardTotalValue(obj) > cardTotalValue(opponent)) {
      return `${obj.name} wins!`
    }
  }
}


Deck.shuffle(30)
_066‍.g.console.log(startGameMenu(startGameOptions))
